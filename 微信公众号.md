微信公众号

1、微信内网页开发（需要使用JSSDK）

JSSDK概述

微信JS-SDK是微信公众平台 面向网页开发者提供的基于微信内的网页开发工具包。

通过使用微信JS-SDK，网页开发者可借助微信高效地使用拍照、选图、语音、位置等手机系统的能力，同时可以直接使用微信分享、扫一扫、卡券、支付等微信特有的能力，为微信用户提供更优质的网页体验。

    // 示例
    wx.chooseImage({
      count: 1, // 默认9
      sizeType: ['original', 'compressed'], // 可以指定是原图还是压缩图，默认二者都有
      sourceType: ['album', 'camera'], // 可以指定来源是相册还是相机，默认二者都有
      success: function (res) {
        var localIds = res.localIds; // 返回选定照片的本地ID列表，localId可以作为img标签的src属性显示图片
      }
    });

JSSDK使用步骤

1. 绑定JS接口安全域名

先登录微信公众平台进入“公众号设置”的“功能设置”里填写“JS接口安全域名”。

1. 引入JS文件

http://res.wx.qq.com/open/js/jweixin-1.4.0.js

1. 通过config接口注入权限验证配置

    wx.config({
      debug: true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
      appId: '', // 必填，公众号的唯一标识
      timestamp: , // 必填，生成签名的时间戳
      nonceStr: '', // 必填，生成签名的随机串
      signature: '',// 必填，签名
      jsApiList: [] // 必填，需要使用的JS接口列表
    });

1. 通过ready接口处理成功验证
2. 通过error接口处理失败验证

2、支持JSSDK调用的后台代码

在上一小节JSSDK使用步骤的第3小步中，需要填写一些参数信息，这些信息需要后台接口提供。

需要由后台接口提供的内容有：

- appId
- timestamp
- nonceStr
- signature

1. 获取access_token

2. 获取jsapi_ticket

3. 签名算法

- 参与签名的字段包括:
  - noncestr(随机字符串)
  - jsapi_ticket
  - timestamp(时间戳，单位秒)
  - url(当前网页的url，不包含#及其后面部分)
- 将上面4个字段按字段名排序，并拼接为"key1=value1&key2=value2"的字符串。
- 将上个步骤中的字符串再做sha1加密
